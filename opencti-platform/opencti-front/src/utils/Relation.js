import { append } from 'ramda';

const relationsTypesMapping = {
  'attack-pattern_vulnerability': ['targets'],
  'threat-actor_attack-pattern': ['uses'],
  'threat-actor_region': ['targets', 'localization'],
  'threat-actor_country': ['targets', 'localization'],
  'threat-actor_city': ['targets', 'localization'],
  'threat-actor_sector': ['targets'],
  'threat-actor_organization': ['targets'],
  'threat-actor_user': ['targets'],
  'threat-actor_malware': ['uses'],
  'threat-actor_tool': ['uses'],
  'threat-actor_vulnerability': ['targets'],
  'intrusion-set_attack-pattern': ['uses'],
  'intrusion-set_region': ['targets', 'localization'],
  'intrusion-set_country': ['targets', 'localization'],
  'intrusion-set_city': ['targets', 'localization'],
  'intrusion-set_sector': ['targets'],
  'intrusion-set_organization': ['targets', 'attributed-to'],
  'intrusion-set_threat-actor': ['attributed-to', 'targets'],
  'intrusion-set_user': ['targets', 'attributed-to'],
  'intrusion-set_tool': ['uses'],
  'intrusion-set_malware': ['uses'],
  'intrusion-set_vulnerability': ['targets'],
  'campaign_threat-actor': ['attributed-to'],
  'campaign_intrusion-set': ['attributed-to'],
  'campaign_attack-pattern': ['uses'],
  campaign_region: ['targets'],
  campaign_country: ['targets'],
  campaign_city: ['targets'],
  campaign_sector: ['targets'],
  campaign_organization: ['targets', 'attributed-to'],
  campaign_user: ['targets', 'attributed-to'],
  campaign_malware: ['uses'],
  campaign_tool: ['uses'],
  campaign_vulnerability: ['targets'],
  'xOpenctiIncident_attack-pattern': ['uses'],
  xOpenctiIncident_region: ['targets'],
  xOpenctiIncident_country: ['targets'],
  xOpenctiIncident_city: ['targets'],
  xOpenctiIncident_organization: ['targets', 'attributed-to'],
  xOpenctiIncident_user: ['targets', 'attributed-to'],
  xOpenctiIncident_sector: ['targets'],
  'xOpenctiIncident_threat-actor': ['attributed-to'],
  'xOpenctiIncident_intrusion-set': ['attributed-to'],
  xOpenctiIncident_campaign: ['attributed-to'],
  xOpenctiIncident_malware: ['uses'],
  xOpenctiIncident_vulnerability: ['targets'],
  'malware_attack-pattern': ['uses'],
  malware_region: ['targets'],
  malware_country: ['targets'],
  malware_city: ['targets'],
  malware_organization: ['targets', 'attributed-to'],
  malware_sector: ['targets'],
  malware_user: ['targets', 'attributed-to'],
  'malware_threat-actor': ['attributed-to'],
  malware_vulnerability: ['targets'],
  malware_tool: ['uses', 'drops'],
  malware_malware: ['variant-of', 'drops'],
  country_region: ['localization'],
  city_country: ['localization'],
  city_region: ['localization'],
  sector_sector: ['gathering'],
  organization_country: ['localization'],
  organization_city: ['localization'],
  organization_region: ['localization'],
  organization_sector: ['gathering'],
  'organization_threat-actor': ['gathering'],
  organization_organization: ['gathering'],
  user_organization: ['gathering'],
  user_country: ['localization'],
  user_city: ['localization'],
  targets_country: ['localization'],
  targets_city: ['localization'],
  targets_region: ['localization'],
  'indicator_stix-relation': ['indicates'],
  indicator_stix_relation: ['indicates'],
  indicator_uses: ['indicates'],
  'indicator_threat-actor': ['indicates'],
  'indicator_intrusion-set': ['indicates'],
  indicator_campaign: ['indicates'],
  indicator_malware: ['indicates'],
  indicator_tool: ['indicates'],
  indicator_vulnerability: ['indicates'],
  'indicator_attack-pattern': ['indicates'],
  observable_organization: ['gathering'],
  observable_user: ['gathering'],
  observable_city: ['localization'],
  observable_country: ['localization'],
  observable_region: ['localization'],
  'ipv4-addr_domain': ['resolves'],
  'ipv6-addr_domain': ['resolves'],
  'ipv4-addr_autonomous-system': ['belongs'],
  'ipv6-addr_autonomous-system': ['belongs'],
  domain_domain: ['resolves'],
  'file-name_file-path': ['corresponds'],
  'file-name_file-md5': ['corresponds'],
  'file-name_file-sha1': ['corresponds'],
  'file-name_file-sha256': ['corresponds'],
  'file-path_file-name': ['corresponds'],
  'file-path_file-md5': ['corresponds'],
  'file-path_file-sha1': ['corresponds'],
  'file-path_file-sha256': ['corresponds'],
  'file-md5_file-name': ['corresponds'],
  'file-md5_file-path': ['corresponds'],
  'file-md5_file-sha1': ['corresponds'],
  'file-md5_file-sha256': ['corresponds'],
  'file-sha1_file-name': ['corresponds'],
  'file-sha1_file-path': ['corresponds'],
  'file-sha1_file-md5': ['corresponds'],
  'file-sha1_file-sha256': ['corresponds'],
  'file-sha256_file-name': ['corresponds'],
  'file-sha256_file-path': ['corresponds'],
  'file-sha256_file-md5': ['corresponds'],
  'file-sha256_file-sha1': ['corresponds'],
};

export const resolveRelationsTypes = (fromType, toType, relatedTo = true) => {
  if (relatedTo) {
    return relationsTypesMapping[`${fromType}_${toType}`]
      ? append('related-to', relationsTypesMapping[`${fromType}_${toType}`])
      : ['related-to'];
  }
  return relationsTypesMapping[`${fromType}_${toType}`]
    ? relationsTypesMapping[`${fromType}_${toType}`]
    : [];
};
