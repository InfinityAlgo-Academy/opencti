define

  ## PROPERTIES

  # migration properties
  uuid sub attribute, datatype string;
  title sub attribute, datatype string;
  lastRun sub attribute, datatype string;
  timestamp sub attribute, datatype long;

  # OpenCTI properties
  internal_id_key sub attribute, datatype string;
  standard_id sub attribute, datatype string;
  created_at sub attribute, datatype date;
  created_at_day sub attribute, datatype string;
  created_at_month sub attribute, datatype string;
  created_at_year sub attribute, datatype string;
  updated_at sub attribute, datatype date;
  issuer sub attribute, datatype string;
  duration sub attribute, datatype string;
  password sub attribute, datatype string;
  user_email sub attribute, datatype string;
  firstname sub attribute, datatype string;
  lastname sub attribute, datatype string;
  language sub attribute, datatype string;
  external sub attribute, datatype boolean;
  grant sub attribute, datatype string;
  default_assignation sub attribute, datatype boolean;
  platform_title sub attribute, datatype string;
  platform_language sub attribute, datatype string;
  platform_email sub attribute, datatype string;
  platform_url sub attribute, datatype string;
  graph_data sub attribute, datatype string;
  workspace_data sub attribute, datatype string;
  workspace_type sub attribute, datatype string;
  object_status sub attribute, datatype long;
  score sub attribute, datatype long;
  ordering sub attribute, datatype double;

  # STIX common properties
  stix_ids sub attribute, datatype string;
  stix_label sub attribute, datatype string;
  entity_type sub attribute, datatype string;
  spec_version sub attribute, datatype string;
  created sub attribute, datatype date;
  modified sub attribute, datatype date;
  revoked sub attribute, datatype boolean;
  first_seen sub attribute, datatype date;
  first_seen_day sub attribute, datatype string;
  first_seen_month sub attribute, datatype string;
  first_seen_year sub attribute, datatype string;
  last_seen sub attribute, datatype date;
  last_seen_day sub attribute, datatype string;
  last_seen_month sub attribute, datatype string;
  last_seen_year sub attribute, datatype string;
  name sub attribute, datatype string;
  description sub attribute, datatype string;
  connector_type sub attribute, datatype string;
  connector_scope sub attribute, datatype string;
  connector_state sub attribute, datatype string;
  connector_state_reset sub attribute, datatype boolean;

  # STIX SDO
  alias sub attribute, datatype string;
  stix_role sub attribute, datatype string;
  objective sub attribute, datatype string;
  goal sub attribute, datatype string;
  sophistication sub attribute, datatype string;
  resource_level sub attribute, datatype string;
  primary_motivation sub attribute, datatype string;
  secondary_motivation sub attribute, datatype string;
  personal_motivation sub attribute, datatype string;
  tool_version sub attribute, datatype string;
  kill_chain_name sub attribute, datatype string;
  phase_name sub attribute, datatype string;
  phase_order sub attribute, datatype long;
  definition_type sub attribute, datatype string;
  definition sub attribute, datatype string;
  level sub attribute, datatype long;
  color sub attribute, datatype string;
  source_name sub attribute, datatype string;
  url sub attribute, datatype string;
  hash sub attribute, datatype string;
  external_id sub attribute, datatype string;
  published sub attribute, datatype date;
  published_day sub attribute, datatype string;
  published_month sub attribute, datatype string;
  published_year sub attribute, datatype string;
  organization_class sub attribute, datatype string;
  report_class sub attribute, datatype string;
  indicator_pattern sub attribute, datatype string;
  indicator_type sub attribute, datatype string;
  main_observable_type sub attribute, datatype string;
  valid_from sub attribute, datatype date;
  valid_from_day sub attribute, datatype string;
  valid_from_month sub attribute, datatype string;
  valid_from_year sub attribute, datatype string;
  valid_until sub attribute, datatype date;
  valid_until_day sub attribute, datatype string;
  valid_until_month sub attribute, datatype string;
  valid_until_year sub attribute, datatype string;
  platform sub attribute, datatype string;
  required_permission sub attribute, datatype string;
  source_confidence_level sub attribute, datatype long;
  confidence sub attribute, datatype long;
  reliability sub attribute, datatype string;
  value sub attribute, datatype string;
  pattern_type sub attribute, datatype string;
  pattern_version sub attribute, datatype string;
  base_score sub attribute, datatype double;
  base_severity sub attribute, datatype string;
  attack_vector sub attribute, datatype string;
  integrity_impact sub attribute, datatype string;
  availability_impact sub attribute, datatype string;
  content sub attribute, datatype string;
  explanation sub attribute, datatype string;
  detection sub attribute, datatype boolean;
  threat_actor_type sub attribute, datatype string;
  is_family sub attribute, datatype boolean;
  number sub attribute, datatype long;
  contact_information sub attribute, datatype string;

  # STIX SRO
  role_played sub attribute, datatype string;
  weight sub attribute, datatype long;
  negative sub attribute, datatype boolean;

  # STIX SOO
  observable_value sub attribute, datatype string;
  observable_date sub attribute, datatype date;

  ## ROLES

  # Migration
  status sub role;
  state sub role;

  # OpenCTI roles
  author sub role;
  authorization sub role;
  client sub role;
  allow sub role;
  allowed sub role;
  grouping sub role;
  member sub role;
  tagging sub role;

  # STIX common roles
  so sub role;
  kill_chain_phase sub role;

  # STIX embeded roles
  creator sub role;
  marking sub role;
  external_reference sub role;
  phase_belonging sub role;
  knowledge_aggregation sub role;

  # STIX observables roles
  soo sub role;
  link_from sub role;
  link_to sub role;

  # STIX SRO roles

  # targets
  source sub role;
  target sub role;

  # uses
  user sub role;
  usage sub role;

  # attributed-to
  attribution sub role;
  origin sub role;

  # mitigates
  mitigation sub role;
  problem sub role;

  # indicates
  indicator sub role;
  characterize sub role;

  # variant-of
  variation sub role;
  original sub role;

  # impersonates
  dummy sub role;
  genuine sub role;

  # related-to
  relate_from sub role;
  relate_to sub role;

  # localization
  localized sub role;
  location sub role;

  # gathering
  part_of sub role;
  gather sub role;

  # drops
  dropped sub role;
  dropping sub role;

  # sighting
  sighted_in sub role;

  ## RELATIONSHIPS
  basic-relationship sub relation,
    abstract,
    has entity_type,
    key internal_id_key;

  internal-relationship sub basic-relationship,
    abstract,
    key standard_id;

  stix-relationship sub basic-relationship,
    abstract,
    has stix_ids,
    has created,
    has modified,
    has revoked,
    has weight,
    has confidence,
    has first_seen,
    has first_seen_day,
    has first_seen_month,
    has first_seen_year,
    has last_seen,
    has last_seen_day,
    has last_seen_month,
    has last_seen_year,
    has name,
    has description,
    has role_played,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays relate_from,
    plays relate_to,
    plays phase_belonging,
    plays characterize,
    plays so;

  stix-meta-relationship sub stix-relationship,
    abstract;

  stix-sighting-relationship sub stix-relationship,
    abstract,
    key standard_stix_id,
    has name,
    has description,
    has created,
    has modified,
    has revoked,
    has entity_type,
    has weight,
    has confidence,
    has negative,
    has number,
    has first_seen,
    has first_seen_day,
    has first_seen_month,
    has first_seen_year,
    has last_seen,
    has last_seen_day,
    has last_seen_month,
    has last_seen_year,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays so,
    relates sighted_in,
    relates so;

  stix-knowledge-relationship sub stix-relationship,
    abstract,
    plays phase_belonging,
    plays so;

  # INTERNAL RELATIONSHIPS
  authorize sub internal-relationship,
    relates client,
    relates authorization;
  migrate sub internal-relationship,
    relates status,
    relates state;
  membership sub internal-relationship,
    relates member,
    relates grouping;
  permission sub internal-relationship,
    has grant,
    relates allowed,
    relates allow;
  user-role sub internal-relationship,
    relates client,
    relates position;
  role-capability sub internal-relationship,
    relates position,
    relates capability;

  # META RELATIONSHIPS
  label sub stix-meta-relationship,
    relates so,
    relates tagging;
  created-by sub stix-meta-relationship,
    relates so,
    relates creator;
  object-marking sub stix-meta-relationship,
    relates so,
    relates marking;
  object sub stix-meta-relationship,
    relates knowledge_aggregation,
    relates so;
  external-reference sub stix-meta-relationship,
    relates so,
    relates external_reference;
  kill-chain-phase sub stix-meta-relationship,
    relates phase_belonging,
    relates kill_chain_phase;

  # SIGHTING RELATIONSHIPS
  sighting-positive sub stix-sighting-relationship;
  sighting-negative sub stix-sighting-relationship;

  # KNOWLEDGE RELATIONSHIPS
  delivers sub stix-knowledge-relationship,
  targets sub stix-knowledge-relationship,
    plays localized,
    relates source,
    relates target;
  uses sub stix-knowledge-relationship,
    relates user,
    relates usage;
  attributed-to sub stix-knowledge-relationship,
    relates origin,
    relates attribution;
  compromises sub stix-knowledge-relationship,
  originates-from sub stix-knowledge-relationship,
  investigates sub stix-knowledge-relationship,
  mitigates sub stix-knowledge-relationship,
    relates mitigation,
    relates problem;
  located-at sub stix-knowledge-relationship,
    relates localized,
    relates location;
  indicates sub stix-knowledge-relationship,
    relates indicator,
    relates characterize;
  based-on sub stix-knowledge-relationship,
    relates observables_aggregation,
    relates soo;
  communicates-with sub stix-knowledge-relationship,
  consists-of sub stix-knowledge-relationship,
  controls sub stix-knowledge-relationship,
  has sub stix-knowledge-relationship,
  hosts sub stix-knowledge-relationship,
  owns sub stix-knowledge-relationship,
  authored-by sub stix-knowledge-relationship,
    relates so,
    relates author;
  beacons-to sub stix-knowledge-relationship,
  exfiltrate-to sub stix-knowledge-relationship,
  downloads sub stix-knowledge-relationship,
  drops sub stix-knowledge-relationship,
    relates dropping,
    relates dropped;
  exploits sub stix-knowledge-relationship,
  variant-of sub stix-knowledge-relationship,
    relates variation,
    relates original;
  characterizes sub stix-knowledge-relationship,
  analysis-of sub stix-knowledge-relationship,
  static-analysis-of sub stix-knowledge-relationship,
  dynamic-analysis-of sub stix-knowledge-relationship,
  impersonates sub stix-knowledge-relationship,
    relates dummy,
    relates genuine;
  related-to substix-knowledge-relationship,
    relates relate_from,
    relates relate_to;
  derived-from sub stix-knowledge-relationship,
  duplicate-of sub stix-knowledge-relationship,
  gathering sub stix-knowledge-relationship,
    relates gather,
    relates part_of;

  ## ENTITIES
  Basic-Object sub entity,
      key internal_id_key,
      has entity_type,
      abstract;

  Internal-Object sub Basic-Object,
      key standard_id,
      abstract;

  Stix-Object sub Basic-Object,
      key standard_stix_id,
      has stix_ids,
      abstract;

  Stix-Core-Object sub Stix-Object,
      abstract;

  Stix-Meta-Object sub Stix-Object,
      abstract;

  Stix-Domain-Object sub Stix-Core-Object,
    abstract,
    has name,
    has description,
    has confidence,
    has stix_label,
    has created,
    has modified,
    has revoked,
    has alias,
    has object_status,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays relate_from,
    plays relate_to,
    plays so;

  Stix-Cyber-Observable sub Stix-Core-Object,
    abstract,

    has entity_type,
    has name,
    has description,
    key observable_value,
    has observable_date,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays so,
    plays soo,
    plays relate_from,
    plays relate_to,
    plays part_of,
    plays link_from,
    plays link_to;

  # INTERNAL OBJECTS
  MigrationStatus sub Internal-Object,
    has lastRun,
    plays status;
  MigrationReference sub Internal-Object,
    has title,
    has timestamp,
    plays state;
  Settings sub Internal-Object,
    has entity_type,
    has platform_title,
    has platform_email,
    has platform_url,
    has platform_language,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at;
  Connector sub Internal-Object,
    has entity_type,
    has name,
    has connector_type,
    has connector_scope,
    has connector_state,
    has connector_state_reset,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at;
  Group sub Internal-Object,
    has entity_type,
    has name,
    has description,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays allowed,
    plays grouping;
  Workspace sub Internal-Object,
    has entity_type,
    has workspace_type,
    has name,
    has description,
    has graph_data,
    has workspace_data,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays so,
    plays knowledge_aggregation;
  Token sub Internal-Object,
    key uuid,
    has entity_type,
    has name,
    has revoked,
    has created,
    has duration,
    has issuer,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays authorization;

  # META ENTITIES
  Marking-Definition sub Stix-Meta-Object,
    has definition_type,
    has definition,
    has level,
    has color,
    plays marking,
    plays allow;
  Label sub Stix-Meta-Object,
    key value,
    has color,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays tagging;



  External-Reference sub Stix-Domain-Object,
    has source_name,
    has description,
    has url,
    has hash,
    has external_id,
    plays external_reference;

  Kill-Chain-Phase sub Stix-Domain,
    has kill_chain_name,
    has phase_name,
    has phase_order,
    plays kill_chain_phase;

  Attack-Pattern sub Stix-Domain-Object,
    has platform,
    has required_permission,
    has external_id,
    plays phase_belonging,
    plays source,
    plays user,
    plays usage,
    plays problem,
    plays characterize;

  Campaign sub Stix-Domain-Object,
    has first_seen,
    has first_seen_day,
    has first_seen_month,
    has first_seen_year,
    has last_seen,
    has last_seen_day,
    has last_seen_month,
    has last_seen_year,
    has objective,
    plays attribution,
    plays origin,
    plays user,
    plays source,
    plays characterize,
    plays phase_belonging;

  Course-Of-Action sub Stix-Domain-Object,
    plays mitigation;

  Identity sub Stix-Domain-Object,
    abstract,
    has contact_information,
    plays gather,
    plays part_of,
    plays creator,
    plays target,
    plays origin,
    plays attribution,
    plays dummy,
    plays user,
    plays genuine,
    plays localized,
    plays sighted_in;

  Region sub Identity,
    plays location;

  Country sub Identity,
    plays localized,
    plays location;

  City sub Identity,
    plays localized,
    plays location;

  Sector sub Identity;

  Organization sub Identity,
    has organization_class,
    has reliability,
    plays characterize;

  Threat-Actor sub Identity,
    has threat_actor_type,
    has first_seen,
    has first_seen_day,
    has first_seen_month,
    has first_seen_year,
    has last_seen,
    has last_seen_day,
    has last_seen_month,
    has last_seen_year,
    has stix_role,
    has goal,
    has sophistication,
    has resource_level,
    has primary_motivation,
    has secondary_motivation,
    has personal_motivation,
    plays attribution,
    plays source,
    plays user,
    plays characterize,
    plays localized;

  User sub Identity,
    key user_email,
    has password,
    has firstname,
    has lastname,
    has language,
    has external,
    plays client,
    plays author,
    plays owner,
    plays member,
    plays allowed,
    plays characterize;

  Role sub Internal-Object,
    key name,
    has entity_type,
    has default_assignation,
    has description,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays position;

  Capability sub Internal-Object,
    key name,
    has ordering,
    has entity_type,
    has description,
    has created_at,
    has created_at_day,
    has created_at_month,
    has created_at_year,
    has updated_at,
    plays capability;

  Incident sub Stix-Domain-Object,
    has objective,
    has first_seen,
    has first_seen_day,
    has first_seen_month,
    has first_seen_year,
    has last_seen,
    has last_seen_day,
    has last_seen_month,
    has last_seen_year,
    plays attribution,
    plays user,
    plays source,
    plays characterize;

  Intrusion-Set sub Stix-Domain-Object,
    has first_seen,
    has first_seen_day,
    has first_seen_month,
    has first_seen_year,
    has last_seen,
    has last_seen_day,
    has last_seen_month,
    has last_seen_year,
    has goal,
    has sophistication,
    has resource_level,
    has primary_motivation,
    has secondary_motivation,
    plays attribution,
    plays source,
    plays user,
    plays origin,
    plays characterize;

  Malware sub Stix-Domain-Object,
    has is_family,
    plays phase_belonging,
    plays source,
    plays user,
    plays variation,
    plays usage,
    plays problem,
    plays characterize,
    plays attribution,
    plays dropping,
    plays dropped,
    plays original;

  Report sub Stix-Domain-Object,
    has report_class,
    has graph_data;
    has published,
    has published_day,
    has published_year,
    has published_month,
    has source_confidence_level,
    plays knowledge_aggregation,
    plays observables_aggregation;

  Note sub Stix-Domain-Object,
    has content,
    plays knowledge_aggregation,
    plays observables_aggregation;

  Opinion sub Stix-Domain-Object,
    has explanation,
    plays knowledge_aggregation,
    plays observables_aggregation;

  Tool sub Stix-Domain-Object,
    has tool_version,
    plays phase_belonging,
    plays source,
    plays user,
    plays usage,
    plays problem,
    plays dropping,
    plays dropped,
    plays characterize;

  Vulnerability sub Stix-Domain-Object,
    has base_score,
    has base_severity,
    has attack_vector,
    has integrity_impact,
    has availability_impact,
    plays target,
    plays problem,
    plays characterize;

  Indicator sub Stix-Domain-Object,
    key indicator_pattern,
    has indicator_type,
    has main_observable_type,
    has pattern_type,
    has pattern_version,
    has score,
    has detection,
    has valid_from,
    has valid_from_day,
    has valid_from_month,
    has valid_from_year,
    has valid_until,
    has valid_until_day,
    has valid_until_month,
    has valid_until_year,
    plays observables_aggregation,
    plays phase_belonging,
    plays indicator;



  Autonomous-System sub Stix-Cyber-Observable;
  Mac-Addr sub Stix-Cyber-Observable;
  Domain-Name sub Stix-Cyber-Observable;
  IPv4-Addr sub Stix-Cyber-Observable;
  IPv6-Addr sub Stix-Cyber-Observable;
  URL sub Stix-Cyber-Observable;
  Email sub Stix-Cyber-Observable;
  Email-Address sub Email;
  Email-Subject sub Email;

  Mutex sub Stix-Cyber-Observable;

  File sub Stix-Cyber-Observable;
  File-Name sub File;
  File-Path sub File;
  File-MD5 sub File;
  File-SHA1 sub File;
  File-SHA256 sub File;

  Directory sub Stix-Cyber-Observable;

  Registry-Key sub Stix-Cyber-Observable;
  Registry-Key-Value sub Registry-Key;

  Hostname sub Stix-Cyber-Observable;

  PDB-Path sub Stix-Cyber-Observable;

  Text sub Stix-Cyber-Observable;

  Process sub Stix-Cyber-Observable;

  User-Account sub Stix-Cyber-Observable;

  Cryptographic-Key sub Stix-Cyber-Observable;

  Cryptocurrency-Wallet sub Stix-Cyber-Observable;

  User-Agent sub Stix-Cyber-Observable;

  Windows-Service sub Stix-Cyber-Observable;
  Windows-Service-Name sub Windows-Service;
  Windows-Service-Display-Name sub Windows-Service;

  Windows-Scheduled-Task sub Stix-Cyber-Observable;

  X509-Certificate sub Stix-Cyber-Observable;
  X509-Certificate-Issuer sub X509-Certificate;
  X509-Certificate-Serial-Number sub X509-Certificate;
