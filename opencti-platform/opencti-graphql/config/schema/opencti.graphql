### DIRECTIVES

directive @auth(for: [Capabilities] = [], and: Boolean = false) on OBJECT | FIELD_DEFINITION
directive @constraint(
  # String constraints
  minLength: Int
  maxLength: Int
  startsWith: String
  endsWith: String
  notContains: String
  pattern: String
  format: String

  # Number constraints
  min: Int
  max: Int
  exclusiveMin: Int
  exclusiveMax: Int
  multipleOf: Int
) on INPUT_FIELD_DEFINITION

### SCALAR

scalar DateTime
scalar ConstraintString
scalar ConstraintNumber
scalar Upload
enum Status {
  wait
  progress
  partial
  complete
  error
}
enum Capabilities {
  CONNECTORAPI
  KNOWLEDGE
  KNOWLEDGE_KNUPDATE
  KNOWLEDGE_KNUPDATE_KNDELETE
  KNOWLEDGE_KNUPLOAD
  KNOWLEDGE_KNASKIMPORT
  KNOWLEDGE_KNGETEXPORT
  KNOWLEDGE_KNGETEXPORT_KNASKEXPORT
  KNOWLEDGE_KNENRICHMENT
  EXPLORE
  EXPLORE_EXUPDATE
  EXPLORE_EXUPDATE_EXDELETE
  MODULES
  MODULES_MODMANAGE
  SETTINGS
  SETTINGS_SETINFERENCES
  SETTINGS_SETACCESSES
  SETTINGS_SETMARKINGS
}

### RELAY

type PageInfo {
  startCursor: String!
  endCursor: String!
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  globalCount: Int!
}
enum OrderingMode {
  asc
  desc
}
enum FilterMode {
  and
  or
}

### EDIT

input EditInput {
  id: ID # ID of the instance in edition
  key: String! # Field name to change
  value: [String]! # Values to apply
}
input EditContext {
  focusOn: String # Field name
}
type EditUserContext {
  name: String!
  focusOn: String # Field name
}

### INTERFACES

###### INTERNAL

############## Logs
type LogsWorkerConfig {
  elasticsearch_url: String!
  elasticsearch_index: String!
  rabbitmq_url: String!
}
enum LogsOrdering {
  event_type
  event_date
}
enum LogsFilter {
  event_type
  entity_id
  connection_id
}
type LogConnection {
  pageInfo: PageInfo!
  edges: [LogEdge]
}
input LogsFiltering {
  key: LogsFilter!
  values: [String]
  operator: String
}
type LogEdge {
  cursor: String!
  node: Log!
}
type Log {
  id: ID!
  event_type: String!
  event_date: DateTime!
  event_user: User
  event_data: String!
  event_message: String!
}

############## Inferences
type Inference {
  id: ID!
  name: String!
  description: String!
  rule: String!
  enabled: Boolean
}

############## Attributes
enum AttributesOrdering {
  value
}
type AttributeConnection {
  pageInfo: PageInfo!
  edges: [AttributeEdge]
}
type AttributeEdge {
  cursor: String!
  node: Attribute!
}
type Attribute {
  id: ID!
  type: String!
  value: String!
}
input AttributeAddInput {
  type: String!
  value: String!
  clientMutationId: String
}
input AttributeEditInput {
  type: String!
  value: String!
  newValue: String!
}

############## Files
type Job {
  id: ID!
  messages: [String]
  job_status: Status!
  created_at: DateTime!
  updated_at: DateTime!
}
type Work {
  id: ID!
  jobs: [Job]
  status: Status!
  connector: Connector
  work_type: String!
  created_at: DateTime!
}
type WorkEdge {
  cursor: String!
  node: Work!
}
type WorkConnection {
  pageInfo: PageInfo!
  edges: [WorkEdge]
}
enum FileCategory {
  import
  export
}
type FileMetadata {
  category: FileCategory!
  encoding: String
  mimetype: String
  listargs: String
}
type File {
  id: ID!
  name: String
  size: Int
  lastModified: DateTime
  lastModifiedSinceMin: Int
  metaData: FileMetadata
  uploadStatus: Status!
  works: [Work]
}
type FileEdge {
  cursor: String!
  node: File!
}
type FileConnection {
  pageInfo: PageInfo!
  edges: [FileEdge]
}

###### ENTITIES

interface BasicObject {
  id: ID! # internal_id
  entity_type: String!
}

######## INTERNAL OBJECT ENTITIES
interface InternalObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # InternalObject
  standard_id: String!
}

############## Settings
type Provider {
  name: String
  type: String
  provider: String
}
type Settings implements InternalObject & BasicObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # InternalObject
  standard_id: String!
  # Settings
  platform_title: String
  platform_email: String
  platform_url: String
  platform_providers: [Provider]
  platform_language: String
  platform_parameters: String
  created_at: DateTime!
  updated_at: DateTime!
  # Technical
  editContext: [EditUserContext]
}

############## Groups
enum GroupsOrdering {
  name
  created_at
  updated_at
}
type GroupConnection {
  pageInfo: PageInfo!
  edges: [GroupEdge]
}
type GroupEdge {
  cursor: String!
  node: Group!
}
type Group implements InternalObject & BasicObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # InternalObject
  standard_id: String!
  # Group
  name: String!
  description: String
  members: UserConnection
  created_at: DateTime
  updated_at: DateTime
  # Technical
  editContext: [EditUserContext]
}
input GroupAddInput {
  name: String!
  description: String
  clientMutationId: String
}

############## Users
enum UsersOrdering {
  name
  user_email
  firstname
  lastname
  language
  external
  created_at
  updated_at
}
enum UsersFilter {
  name
  confidence
  alias
  entity_type
  created
  modified
  created_at
  createdBy
  markingDefinitions
  labels
}
input UsersFiltering {
  key: UsersFilter!
  values: [String]
  operator: String
}
type UserConnection {
  pageInfo: PageInfo!
  edges: [UserEdge]
}
type UserEdge {
  cursor: String!
  node: User!
}
type User implements BasicObject & InternalObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # InternalObject
  standard_id: String!
  # User
  user_email: String!
  name: String!
  firstname: String
  lastname: String
  language: String
  external: Boolean
  roles: [Role]!
  capabilities: [Capability]!
  groups: GroupConnection
  token: String
  # Technical
  editContext: [EditUserContext]
}
input UserAddInput {
  user_email: String @constraint(minLength: 5, format: "email")
  name: String! @constraint(minLength: 3)
  password: String
  firstname: String
  lastname: String
  language: String
  roles: [ID]
}

############## Roles
enum RolesOrdering {
  name
  created_at
  updated_at
}
type RoleConnection {
  pageInfo: PageInfo!
  edges: [RoleEdge]
}
type RoleEdge {
  cursor: String!
  node: Role!
}
type Role implements BasicObject & InternalObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # InternalObject
  standard_id: String!
  # Role
  name: String!
  default_assignation: Boolean
  description: String
  created_at: DateTime!
  updated_at: DateTime!
  capabilities: [Capability]
  editContext: [EditUserContext]
}
input RoleAddInput {
  name: String!
  description: String
  clientMutationId: String
}

############## Capabilities
type CapabilityConnection {
  pageInfo: PageInfo!
  edges: [CapabilityEdge]
}
type CapabilityEdge {
  cursor: String!
  node: Capability!
}
type Capability implements BasicObject & InternalObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # InternalObject
  standard_id: String!
  # Capability
  name: String!
  description: String
  attribute_order: Int
  created_at: DateTime!
  updated_at: DateTime!
  # Technical
  editContext: [EditUserContext]
}

############## Connectors
enum ConnectorType {
  EXTERNAL_IMPORT
  INTERNAL_IMPORT_FILE
  INTERNAL_ENRICHMENT
  INTERNAL_EXPORT_FILE
}
input RegisterConnectorInput {
  id: ID!
  name: String!
  type: ConnectorType!
  scope: [String!]
}
type ConnectorConfig {
  uri: String!
  listen: String!
  listen_exchange: String!
  push: String!
  push_exchange: String!
}
type Connector implements BasicObject & InternalObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # InternalObject
  standard_id: String!
  # Connector
  name: String!
  connector_type: String
  connector_scope: [String!]
  connector_state: String
  connector_state_reset: Boolean
  updated_at: DateTime
  created_at: DateTime
  config: ConnectorConfig
}

############## Workspaces
enum WorkspacesOrdering {
  name
  created_at
  updated_at
}
enum WorkspacesFilter {
  workspace_type
}
input WorkspacesFiltering {
  key: WorkspacesFilter!
  values: [String]
  operator: String
}
type WorkspaceConnection {
  pageInfo: PageInfo!
  edges: [WorkspaceEdge]
}
type WorkspaceEdge {
  cursor: String!
  node: Workspace!
}
type Workspace implements BasicObject & InternalObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # InternalObject
  standard_id: String!
  # Workspace
  workspace_type: String!
  name: String!
  description: String
  graph_data: String
  workspace_data: String
  created_at: DateTime!
  updated_at: DateTime!
  # Technical
  editContext: [EditUserContext]
}
input WorkspaceAddInput {
  workspace_type: String!
  name: String!
  description: String
  clientMutationId: String
}

######## STIX OBJECT ENTITIES
interface StixObject implements BasicObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
}

######## STIX META OBJECT ENTITIES
interface StixMetaObject implements BasicObject & StixObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixMetaObject
  created: DateTime!
  modified: DateTime!
}

############## MarkingDefinitions
enum MarkingDefinitionsOrdering {
  definition_type
  definition
  attribute_order
  color
  created
  modified
  created_at
  updated_at
}
enum MarkingDefinitionsFilter {
  definition
  definition_type
  markedBy
}
input MarkingDefinitionsFiltering {
  key: MarkingDefinitionsFilter!
  values: [String]
  operator: String
}
type MarkingDefinitionConnection {
  pageInfo: PageInfo!
  edges: [MarkingDefinitionEdge]
}
type MarkingDefinitionEdge {
  cursor: String!
  node: MarkingDefinition!
}
type MarkingDefinition implements BasicObject & StixObject & StixMetaObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixMetaObject
  created: DateTime!
  modified: DateTime!
  # MarkingDefinition
  definition_type: String
  definition: String
  attribute_order: Int
  color: String
  # Technical
  toStix: String
  editContext: [EditUserContext]
}
input MarkingDefinitionAddInput {
  stix_id: String
  definition_type: String!
  definition: String!
  attribute_order: Int!
  color: String
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

############## Labels
enum LabelsOrdering {
  value
  color
  created
  modified
  created_at
  updated_at
}
enum LabelsFilter {
  value
  markedBy
}
input LabelsFiltering {
  key: MarkingDefinitionsFilter!
  values: [String]
  operator: String
}
type LabelConnection {
  pageInfo: PageInfo!
  edges: [LabelEdge]
}
type LabelEdge {
  cursor: String!
  node: MarkingDefinition!
}
type Label implements BasicObject & StixObject & StixMetaObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixMetaObject
  created: DateTime!
  modified: DateTime!
  # MarkingDefinition
  value: String
  color: String
  # Technical
  toStix: String
  editContext: [EditUserContext]
}
input LabelAddInput {
  stix_id: String
  value: String!
  color: String
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

############## ExternalReferences
enum ExternalReferencesOrdering {
  source_name
  url
  hash
  external_id
  created
  modified
  created_at
  updated_at
}
enum ExternalReferencesFilter {
  url
  usedBy
}
input ExternalReferencesFiltering {
  key: ExternalReferencesFilter!
  values: [String]
  operator: String
}
type ExternalReferenceConnection {
  pageInfo: PageInfo!
  edges: [ExternalReferenceEdge]
}
type ExternalReferenceEdge {
  cursor: String!
  node: ExternalReference!
}
type ExternalReference implements BasicObject & StixObject & StixMetaObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixMetaObject
  created: DateTime!
  modified: DateTime!
  # ExternalReference
  source_name: String!
  description: String
  url: String
  hash: String
  external_id: String
  # Technical
  editContext: [EditUserContext]
}
input ExternalReferenceAddInput {
  stix_id: String
  source_name: String!
  description: String
  url: String
  hash: String
  external_id: String
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

############## KillChainPhases
enum KillChainPhasesOrdering {
  phase_order
  kill_chain_name
  phase_name
  created
  modified
  created_at
  updated_at
}
enum KillChainPhasesFilter {
  kill_chain_name
  phase_name
}
input KillChainPhasesFiltering {
  key: KillChainPhasesFilter!
  values: [String]
  operator: String
}
type KillChainPhaseConnection {
  pageInfo: PageInfo!
  edges: [KillChainPhaseEdge]
}
type KillChainPhaseEdge {
  cursor: String!
  node: KillChainPhase!
}
type KillChainPhase implements BasicObject & StixObject & StixMetaObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixMetaObject
  created: DateTime!
  modified: DateTime!
  # KillChainPhase
  kill_chain_name: String!
  phase_name: String!
  attribute_order: Int
  # Technical
  editContext: [EditUserContext]
}
input KillChainPhaseAddInput {
  stix_id: String
  kill_chain_name: String!
  phase_name: String!
  phase_order: Int!
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

######## STIX CORE OBJECT ENTITIES

union OrganizationOrIndividual = Organization | Individual
interface StixCoreObject implements BasicObject & StixObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
}

########## STIX DOMAIN OBJECT ENTITIES
interface StixDomainObject implements BasicObject & StixObject & StixCoreObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
}

############## AttackPatterns
enum AttackPatternsOrdering {
  external_id
  name
  created
  modified
  created_at
  updated_at
  markingDefinitions
  labels
  killChainPhases
}
enum AttackPatternsFilter {
  name
  alias
  created
  modified
  created_at
  updated_at
  x_mitre_id
  createdBy
  markedBy
  labelledBy
  mitigatedBy
}
input AttackPatternsFiltering {
  key: AttackPatternsFilter!
  values: [String]
  operator: String
}
type AttackPatternConnection {
  pageInfo: PageInfo!
  edges: [AttackPatternEdge]
}
type AttackPatternEdge {
  cursor: String!
  node: AttackPattern!
}
type AttackPattern implements BasicObject & StixObject & StixCoreObject & StixDomainObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # AttackPattern
  name: String!
  description: String
  aliases: [String]
  x_mitre_platforms: [String]
  x_mitre_permissions_required: [String]
  x_mitre_detection: String
  x_mitre_id: String
  killChainPhases: KillChainPhaseConnection
  coursesOfAction: CourseOfActionConnection
  # Technical
  creator: User
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  toStix: String
  editContext: [EditUserContext]
}
input AttackPatternAddInput {
  stix_id: String
  name: String! @constraint(minLength: 3)
  description: String!
  aliases: [String]
  confidence: Int
  x_mitre_platforms: [String]
  x_mitre_permissions_required: [String]
  x_mitre_detection: String
  x_mitre_id: String
  createdBy: String
  markingDefinitions: [String]
  labels: [String]
  killChainPhases: [String]
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

############## Campaigns
enum CampaignsOrdering {
  name
  first_seen
  last_seen
  created
  modified
  created_at
  updated_at
  markingDefinitions
  labels
}
enum CampaignsFilter {
  name
  alias
  created
  modified
  created_at
  updated_at
  createdBy
  markedBy
  labelledBy
}
input CampaignsFiltering {
  key: CampaignsFilter!
  values: [String]
  operator: String
}
type CampaignConnection {
  pageInfo: PageInfo!
  edges: [CampaignEdge]
}
type CampaignEdge {
  cursor: String!
  node: Campaign!
}
type Campaign implements BasicObject & StixObject & StixCoreObject & StixDomainObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # Campaign
  name: String!
  description: String
  aliases: [String]
  first_seen: DateTime
  last_seen: DateTime
  objective: String
  # Technical
  creator: User
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  toStix: String
  editContext: [EditUserContext]
}
input CampaignAddInput {
  stix_id: String
  name: String! @constraint(minLength: 3)
  description: String!
  aliases: [String]
  confidence: Int
  first_seen: DateTime
  last_seen: DateTime
  objective: String
  createdBy: String
  markingDefinitions: [String]
  labels: [String]
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

############## CoursesOfAction
enum CoursesOfActionOrdering {
  name
  created
  modified
  created_at
  updated_at
  labels
  markingDefinitions
}
enum CoursesOfActionFilter {
  name
  alias
  created
  modified
  created_at
  createdBy
  markingDefinitions
  labels
  mitigateBy
}
input CoursesOfActionFiltering {
  key: CoursesOfActionFilter!
  values: [String]
  operator: String
}
type CourseOfActionConnection {
  pageInfo: PageInfo!
  edges: [CourseOfActionEdge]
}
type CourseOfActionEdge {
  cursor: String!
  node: CourseOfAction!
}
type CourseOfAction implements BasicObject & StixObject & StixCoreObject & StixDomainObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # CourseOfAction
  name: String!
  description: String
  # Technical
  creator: User
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  toStix: String
  editContext: [EditUserContext]
}
input CourseOfActionAddInput {
  stix_id: String
  name: String! @constraint(minLength: 3)
  description: String!
  confidence: Int
  createdBy: String
  markingDefinitions: [String]
  labels: [String]
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

############## Identities
interface Identity implements BasicObject & StixObject & StixCoreObject & StixDomainObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # Identity
  name: String!
  aliases: [String]
  contact_information: String
}

################ Individuals
enum IndividualsOrdering {
  name
  confidence
  firstname
  lastname
  created
  modified
  labels
  markingDefinitions
}
enum IndividualsFilter {
  name
  aliases
  alias
  created
  modified
  created_at
  createdBy
  markedBy
  labelledBy
}
input IndividualsFiltering {
  key: IndividualsFilter!
  values: [String]
  operator: String
}
type IndividualConnection {
  pageInfo: PageInfo!
  edges: [UserEdge]
}
type IndividualEdge {
  cursor: String!
  node: User!
}
type Individual implements BasicObject & StixObject & StixCoreObject & StixDomainObject & Identity {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # Identity
  name: String!
  aliases: [String]
  contact_information: String
  # Individual
  x_opencti_firstname: String
  x_opencti_lastname: String
  # Technical
  creator: User
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  toStix: String
  editContext: [EditUserContext]
}
input IndividualAddInput {
  stix_id: String
  name: String! @constraint(minLength: 3)
  description: String!
  aliases: [String]
  contact_information: String
  x_opencti_firstname: String
  x_opencti_lastname: String
  confidence: Int
  createdBy: String
  markingDefinitions: [String]
  labels: [String]
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

################ Organizations
enum OrganizationsOrdering {
  name
  confidence
  created
  modified
  labels
  markingDefinitions
}
enum OrganizationsFilter {
  name
  aliases
  alias
  created
  modified
  created_at
  updated_at
  createdBy
  markedBy
  labelledBy
}
input OrganizationsFiltering {
  key: OrganizationsFilter!
  values: [String]
  operator: String
}
type OrganizationConnection {
  pageInfo: PageInfo!
  edges: [OrganizationEdge]
}
type OrganizationEdge {
  cursor: String!
  node: User!
}
enum OrganizationReliability {
  A
  B
  C
  D
  E
  F
}
type Organization implements BasicObject & StixObject & StixCoreObject & StixDomainObject & Identity {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # Identity
  name: String!
  aliases: [String]
  contact_information: String
  # Organization
  x_opencti_organization_type: String
  x_opencti_reliability: OrganizationReliability
  # Technical
  creator: User
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  toStix: String
  editContext: [EditUserContext]

}
input OrganizationAddInput {
  stix_id: String
  name: String! @constraint(minLength: 3)
  description: String!
  aliases: [String]
  contact_information: String
  confidence: Int
  x_opencti_organization_type: String
  x_opencti_reliability: OrganizationReliability
  createdBy: String
  markingDefinitions: [String]
  labels: [String]
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

################ Sectors
enum SectorsOrdering {
  name
  description
  confidence
  created
  modified
  created_at
  updated_at
  labels
  markingDefinitions
}
enum SectorsFilter {
  name
  confidence
  created
  modified
  created_at
  updated_at
  createdBy
  markingDefinitions
  labels
  partOf
}
input SectorsFiltering {
  key: SectorsFilter!
  values: [String]
  operator: String
}
type SectorConnection {
  pageInfo: PageInfo!
  edges: [SectorEdge]
}
type SectorEdge {
  cursor: String!
  node: Sector!
}
type Sector implements BasicObject & StixObject & StixCoreObject & StixDomainObject & Identity {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # Identity
  name: String!
  aliases: [String]
  contact_information: String
  # Sector
  name: String!
  description: String
  aliases: [String]
  parentSectors: SectorConnection
  subSectors: SectorConnection
  isSubSector: Boolean
  # Technical
  creator: User
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  toStix: String
  editContext: [EditUserContext]
}
input SectorAddInput {
  stix_id: String
  name: String! @constraint(minLength: 3)
  description: String!
  aliases: [String]
  contact_information: String
  confidence: Int
  createdBy: String
  markingDefinitions: [String]
  labels: [String]
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

############## Indicators
enum IndicatorsOrdering {
  pattern_type
  pattern_version
  pattern
  name
  indicator_types
  valid_from
  valid_until
  x_opencti_score
  x_opencti_detection
  confidence
  created
  modified
  created_at
  updated_at
  labels
  markingDefinitions
}
enum IndicatorsFilter {
  name
  pattern_type
  pattern_version
  pattern
  x_opencti_main_observable_type
  valid_from
  valid_until
  created
  modified
  created_at
  updated_at
  createdBy
  markedBy
  labelledBy
  basedOn
}
input IndicatorsFiltering {
  key: IndicatorsFilter!
  values: [String]
  operator: String
}
type IndicatorConnection {
  pageInfo: PageInfo!
  edges: [IndicatorEdge]
}
type IndicatorEdge {
  cursor: String!
  node: Indicator!
}
type Indicator implements BasicObject & StixObject & StixCoreObject & StixDomainObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # Indicator
  pattern_type: String
  pattern_version: String
  pattern: String
  name: String!
  description: String
  indicator_types: String
  valid_from: DateTime
  valid_until: DateTime
  x_opencti_score: Int
  x_opencti_detection: Boolean
  x_opencti_main_observable_type: String
  # Technical
  creator: User
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  toStix: String
  editContext: [EditUserContext]
}
input IndicatorAddInput {
  stix_id: String
  pattern_type: String!
  pattern_version: String
  pattern: String!
  name: String!
  description: String
  valid_from: DateTime
  valid_until: DateTime
  x_opencti_score: Int
  x_opencti_detection: Boolean
  x_opencti_main_observable_type: String!
  confidence: Int
  createdBy: String
  markingDefinitions: [String]
  labels: [String]
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

############## Infrastructures
enum InfrastructuresOrdering {
  name
  infrastructure_types
  first_seen
  last_seen
  created
  modified
  created_at
  updated_at
  labels
  markingDefinitions
}
enum InfrastructuresFilter {
  name
  aliases
  infrastructure_types
  first_seen
  last_seen
  created
  modified
  created_at
  updated_at
  createdBy
  markedBy
  labelledBy
}
input InfrastructuresFiltering {
  key: InfrastructuresFilter!
  values: [String]
  operator: String
}
type InfrastructureConnection {
  pageInfo: PageInfo!
  edges: [InfrastructureEdge]
}
type InfrastructureEdge {
  cursor: String!
  node: Indicator!
}
type Infrastructure implements BasicObject & StixObject & StixCoreObject & StixDomainObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # Infrastructure
  name: String!
  description: String
  infrastructure_types: String
  first_seen: DateTime
  last_seen: DateTime
  # Technical
  creator: User
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  toStix: String
  editContext: [EditUserContext]
}
input InfrastructureAddInput {
  stix_id: String
  name: String!
  description: String
  infrastructure_types: [String]
  first_seen: DateTime
  last_seen: DateTime
  confidence: Int
  createdBy: String
  markingDefinitions: [String]
  labels: [String]
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

############## IntrusionSets
enum IntrusionSetsOrdering {
  name
  created
  modified
  created_at
  updated_at
  labels
  markingDefinitions
}
enum IntrusionSetsFilter {
  name
  alias
  created
  modified
  created_at
  updated_at
  createdBy
  markedBy
  labelledBy
}
input IntrusionSetsFiltering {
  key: IntrusionSetsFilter!
  values: [String]
  operator: String
}
type IntrusionSetConnection {
  pageInfo: PageInfo!
  edges: [IntrusionSetEdge]
}
type IntrusionSetEdge {
  cursor: String!
  node: IntrusionSet!
}
type IntrusionSet implements StixDomainObject & StixCoreObject & StixObject & BasicObject {
  # BasicObject
  id: ID! # internal_id
  entity_type: String!
  # StixObject
  standard_stix_id: String!
  stix_ids: [String]
  spec_version: String!
  created_at: DateTime!
  updated_at: DateTime!
  # StixCoreObject
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
  # StixDomainObject
  revoked: Boolean!
  confidence: Int
  lang: String
  created: DateTime!
  modified: DateTime!
  # IntrusionSet
  name: String!
  description: String
  aliases: [String]
  first_seen: DateTime
  last_seen: DateTime
  goals: [String]
  resource_level: String
  primary_motivation: String
  secondary_motivations: [String]
  # Technical
  creator: User
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  toStix: String
  editContext: [EditUserContext]
}
input IntrusionSetAddInput {
  stix_id: String
  name: String!
  description: String!
  aliases: [String]
  first_seen: DateTime
  last_seen: DateTime
  goals: [String]
  resource_level: String
  primary_motivation: String
  secondary_motivations: [String]
  confidence: Int
  createdByRef: String
  markingDefinitions: [String]
  labels: [String]
  created: DateTime
  modified: DateTime
  clientMutationId: String
}

interface Location implements StixDomainObject & StixCoreObject & StixObject & BasicObject {
  id: ID!
  entity_type: String!
  standard_stix_id: String!
  stix_ids: [String]
  name: String!
  description: String
  labels: LabelConnection
  reports: ReportConnection
  notes: NoteConnection
  editContext: [EditUserContext]
  creator: User
  toStix: String
  created_at: DateTime!
  updated_at: DateTime!
  createdByRef: Identity
  markingDefinitions: MarkingDefinitionConnection
  externalReferences(first: Int): ExternalReferenceConnection
  alias: [String]
  confidence: Int
  graph_data: String
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixRelationsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixRelationConnection
  importFiles(first: Int): FileConnection
  exportFiles(first: Int): FileConnection
  created: DateTime
  modified: DateTime
  # Location
  latitude: Float
  longitude: Float
  precision: Float
}


###### RELATIONSHIPS

interface BasicRelationship {
  id: ID! # internal_id_key
  entity_type: String!
  fromRole: String
  toRole: String
}

######## INTERNAL RELATIONSHIPS

type InternalRelationship implements BasicRelationship {
  # BasicRelationship
  id: ID! # internal_id_key
  entity_type: String!
  fromRole: String
  toRole: String
  # InternalRelationship
  standard_id: String!
  from: InternalObject
  to: InternalObject
}


######## STIX RELATIONSHIPS

union StixCoreObjectOrStixRelationship = StixCoreObject | StixRelationship
interface StixRelationship implements BasicRelationship {
  # BasicRelationship
  id: ID! # internal_id_key
  entity_type: String!
  fromRole: String
  toRole: String
  # StixRelationship
  standard_stix_id: String!
  stix_ids: [String]
  from: StixCoreObjectOrStixRelationship
  to: StixCoreObjectOrStixRelationship
  inferred: Boolean
}

############## StixCoreRelationships
enum StixCoreRelationshipsOrdering {
  entity_type
  confidence
  weight
  first_seen
  last_seen
  created
  modified
  created_at
  updated_at
  toName
  toValidFrom
  toValidUntil
  toPatternType
  toCreatedAt
}
enum StixCoreRelationshipsFilter {
  created
  modified
  created_at
  confidence
  createdBy
  markingDefinitions
  labels
  toPatternType
  toMainObservableType
}
input StixCoreRelationshipsFiltering {
  key: StixCoreRelationshipsFilter!
  values: [String]
  operator: String
}
type StixCoreRelationshipConnection {
  pageInfo: PageInfo!
  edges: [StixCoreRelationshipEdge]
}
type StixCoreRelationshipEdge {
  cursor: String!
  node: StixCoreRelationship!
}
type StixCoreRelationship implements BasicRelationship & StixRelationship {
  # BasicRelationship
  id: ID! # internal_id_key
  entity_type: String!
  fromRole: String
  toRole: String
  # StixRelationship
  standard_stix_id: String!
  stix_ids: [String]
  from: StixCoreObjectOrStixRelationship
  to: StixCoreObjectOrStixRelationship
  inferred: Boolean
  # StixCoreRelationship
  start_time: DateTime
  stop_time: DateTime
  revoked: Boolean!
  confidence: Int
  lang: String
  createdBy: OrganizationOrIndividual
  markingDefinitions: MarkingDefinitionConnection
  labels: LabelConnection
  externalReferences(first: Int): ExternalReferenceConnection
  reports: ReportConnection
  notes: NoteConnection
  opinions: OpinionConnection
  stixCoreRelationships(
    first: Int
    after: ID
    orderBy: StixCoreRelationshipsOrdering
    orderMode: OrderingMode
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    filters: [StixCoreRelationshipsFiltering]
    filterMode: FilterMode
    forceNatural: Boolean
  ): StixCoreRelationshipConnection
}

input StixRelationAddInput {
  internal_id_key: String
  stix_id: String
  fromId: String!
  fromRole: String!
  toId: String!
  toRole: String!
  relationship_type: String!
  role_played: String
  weight: Int
  confidence: Int
  description: String
  first_seen: DateTime
  last_seen: DateTime
  createdByRef: String
  markingDefinitions: [String]
  killChainPhases: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}
## STIX relations

### STIX sightinhs
enum StixSightingsOrdering {
  confidence
  number
  negative
  first_seen
  last_seen
  created
  modified
  created_at
  updated_at
  toName
  toValidFrom
  toValidUntil
  toPatternType
  toCreatedAt
}
enum StixSightingsFilter {
  negative
  created
  modified
  created_at
  confidence
  createdBy
  markingDefinitions
  labels
  toPatternType
  toMainObservableType
}
input StixSightingsFiltering {
  key: StixSightingsFilter!
  values: [String]
  operator: String
}
type StixSightingConnection {
  pageInfo: PageInfo!
  edges: [StixSightingEdge]
}
type StixSightingEdge {
  cursor: String!
  node: StixSightingRelationship!
}
input StixSightingAddInput {
  internal_id_key: String
  stix_id: String
  fromId: String!
  toId: String
  confidence: Int!
  number: Int!
  negative: Boolean
  description: String
  first_seen: DateTime
  last_seen: DateTime
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}